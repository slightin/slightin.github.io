import{_ as c,W as i,X as l,$ as u,Y as n,Z as s,a0 as a,a2 as p,a1 as r,C as o}from"./framework-474f8844.js";const k={},d=n("h1",{id:"学习通自动讨论",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#学习通自动讨论","aria-hidden":"true"},"#"),s(" 学习通自动讨论")],-1),v=n("p",null,"仅在讨论界面生效，用于自动讨论超星学习通网络选修课",-1),m=n("strong",null,"旧版",-1),b=n("s",null,"后续可能会支持新版的学习通网页",-1),f=r(`<ul><li>增加开始讨论按钮，点击后执行脚本，防止在专业课讨论区执行;</li><li>增加计数和文字提醒</li></ul><figure><img src="https://scriptcat.org/api/v1/resource/image/zps4inDq9hSvOSlI" alt="预览" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://scriptcat.org/api/v1/resource/image/Emr0Ge52JVnw1gAk" alt="预览" tabindex="0" loading="lazy"><figcaption>预览</figcaption></figure><details class="hint-container details"><summary>源码</summary><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// ==UserScript==</span>
<span class="token comment">// @name         学习通自动讨论</span>
<span class="token comment">// @namespace    https://scriptcat.org/users/27321</span>
<span class="token comment">// @version      2.3.2</span>
<span class="token comment">// @description  自动讨论，仅在讨论界面生效，用于自动讨论学习通网络选修课的50讨论</span>
<span class="token comment">// @author       万事可乐</span>
<span class="token comment">// @match        *://*/bbscircle/grouptopic*</span>
<span class="token comment">// @match        *://mooc2-ans.chaoxing.com/mycourse/stu?*s</span>
<span class="token comment">// @icon         https://groupweb.chaoxing.com/favicon.ico</span>
<span class="token comment">// @grant        none</span>
<span class="token comment">// ==/UserScript==</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> times<span class="token operator">=</span><span class="token number">50</span> <span class="token comment">//自动讨论次数，默认50条</span>
    <span class="token keyword">var</span> clicktime<span class="token operator">=</span><span class="token number">1500</span> <span class="token comment">//每次页面加载后发送讨论的延迟，不建议太小，单位为毫秒</span>

    <span class="token comment">// code here...</span>
    <span class="token keyword">var</span> tips <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;title1118&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">var</span> tip<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span>
    tips<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>tip<span class="token punctuation">)</span>
    tip<span class="token punctuation">.</span>innerText<span class="token operator">=</span><span class="token string">&quot;当前设置为自动讨论 &quot;</span><span class="token operator">+</span>times<span class="token operator">+</span><span class="token string">&quot; 条&quot;</span>
    tip<span class="token punctuation">.</span>style<span class="token operator">=</span><span class="token string">&quot;font-size:18px;color:rgb(230 15 15)&quot;</span>

    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;body &gt; div.main1118 &gt; div:nth-child(3)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token operator">=</span><span class="token string">&quot;temp&quot;</span>
    <span class="token keyword">var</span> temp <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;temp&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">var</span> count<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">var</span> string<span class="token operator">=</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        count<span class="token operator">=</span><span class="token function">Number</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">讨论</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//阻止弹窗</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token operator">+</span>string<span class="token punctuation">,</span><span class="token string">&quot;#&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//因网站刷新后脚本重新载入，所以用网址存储次数</span>
        document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#c_title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">=</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#addGroupTopicForm &gt; div &gt; div.listBtn &gt; a.qdBtn.fr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>clicktime<span class="token punctuation">)</span><span class="token comment">//延迟，不建议太小</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">addback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> back<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>back<span class="token punctuation">)</span>
        back<span class="token punctuation">.</span>style<span class="token operator">=</span><span class="token string">&quot;font-size:20px;width: 100px;height:40px;margin:6px;margin-left: 100px&quot;</span>
        back<span class="token punctuation">.</span>innerText<span class="token operator">=</span><span class="token string">&quot;重置&quot;</span>
        back<span class="token punctuation">.</span><span class="token function-variable function">onclick</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;body &gt; div.main1118 &gt; div.title1118 &gt; a:nth-child(4) &gt; span&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> button<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span>
        button<span class="token punctuation">.</span>style<span class="token operator">=</span><span class="token string">&quot;font-size:20px;width: 200px;height:40px&quot;</span>
        button<span class="token punctuation">.</span>innerText<span class="token operator">=</span><span class="token string">&quot;开始讨论&quot;</span>
        button<span class="token punctuation">.</span><span class="token function-variable function">onclick</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            location<span class="token punctuation">.</span>href<span class="token operator">=</span>location<span class="token punctuation">.</span>href<span class="token operator">+</span><span class="token string">&quot;#0&quot;</span>
            location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">&lt;</span>times<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> div<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span>
        div<span class="token punctuation">.</span>style<span class="token operator">=</span><span class="token string">&quot;font-size:20px&quot;</span>
        div<span class="token punctuation">.</span>innerText<span class="token operator">=</span><span class="token string">&quot;正在自动讨论，已讨论 &quot;</span><span class="token operator">+</span>string<span class="token operator">+</span><span class="token string">&quot; 条&quot;</span>
        <span class="token function">讨论</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">==</span>times<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> div2<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div2<span class="token punctuation">)</span>
        div2<span class="token punctuation">.</span>style<span class="token operator">=</span><span class="token string">&quot;font-size:20px;float:left&quot;</span>
        div2<span class="token punctuation">.</span>innerText<span class="token operator">=</span><span class="token string">&quot;自动讨论已经完成，本次讨论 &quot;</span><span class="token operator">+</span>times<span class="token operator">+</span><span class="token string">&quot; 条&quot;</span>
        <span class="token keyword">var</span> div3<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span>
        div2<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div3<span class="token punctuation">)</span>
        div3<span class="token punctuation">.</span>style<span class="token operator">=</span><span class="token string">&quot;font-size:10px&quot;</span>
        div3<span class="token punctuation">.</span>innerText<span class="token operator">=</span><span class="token string">&quot;可能有延迟，若讨论条数不足，建议重新从课程页进入该页面查看，或点击右侧重置按钮&quot;</span>
        <span class="token function">addback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;自动讨论已经完成&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> terror<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>terror<span class="token punctuation">)</span>
        terror<span class="token punctuation">.</span>style<span class="token operator">=</span><span class="token string">&quot;font-size:25px;margin:6px;color:rgb(250 15 15);float:left&quot;</span>
        terror<span class="token punctuation">.</span>innerText<span class="token operator">=</span><span class="token string">&quot;出现异常，请点击右侧重置按钮&quot;</span>
        <span class="token function">addback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><hr>`,5),g={href:"https://scriptcat.org/script-show-page/220",class:"fright",target:"_blank",rel:"noopener noreferrer"},q=n("img",{src:"https://scriptcat.org/assets/logo.png",height:"14"},null,-1),h=n("p",null,"开发者不对任何下载者和使用者的任何行为负责。",-1);function y(w,x){const t=o("font"),e=o("ExternalLinkIcon");return i(),l("div",null,[d,v,u(" more "),n("p",null,[s("请在"),a(t,{color:"red"},{default:p(()=>[m]),_:1}),s("学习通网页中运行此脚本，"),b,a(t,{color:"red"},{default:p(()=>[s(" 本脚本已归档并停止维护")]),_:1})]),f,n("p",null,[s("此脚本仅用于脚本爱好者内部交流学习使用, "),n("a",g,[s("在"),q,s("脚本猫中安装"),a(e)])]),h])}const E=c(k,[["render",y],["__file","autotalk.html.vue"]]);export{E as default};
